<link href="../../css/00-navbar-alternate.css" rel="alternate stylesheet" type="text/css" title="alternate">
<nav  id="defaultNavbar" role="navigation" class="navbar navbar-default navbar-fixed-top">
    <div id="message"></div>
    <div class="container-fluid">
        <div class="navbar-header navbar-left pull-left">
            <button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="btn btn-default btn-sm navbar-btn pull-left">
                Menu
            </button>
            <div class="navbar-brand hidden-xs hidden-sm">
                <a class="logo-navbar"></a>
            </div>
        </div>
        <div class="navbar-header navbar-right pull-right">
            <ul class="nav navbar-nav navbar-right">
                <li class="hidden visible-xs pull-left">
                    <a class="label-success navbar-link">
                        <i class="fas fa-sack-dollar fa-fw"></i>
                        <div class="pull-right" style="width: 60px; white-space: normal;float:right;line-height: 1;font-size: 13px; text-align: center;">Get Paid Faster! </div>
                    </a>
                </li>
                <li class="hidden visible-xs visible-sm dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fas fa-search fa-fw"></i></a>
                    <ul class="dropdown-menu dropdown-menu-right" style="padding: 15px;min-width: 250px;">
                        <li>
                            <div class="row">
                                <div class="col-md-12">
                                    <form>
                                        <div class="input-group input-group-sm ">
                                            <span class="input-group-addon dropdown-toggle" data-toggle="dropdown"
                                                aria-haspopup="true" aria-expanded="false">
                                                <span class="caret"></span>
                                            </span>
                                            <ul class="dropdown-menu dropdown-menu-left">
                                                <li onclick="setGlobalSearchPlaceholder($(this).first().text());"><a>Invoice #</a></li>
                                                <li onclick="setGlobalSearchPlaceholder($(this).first().text());"><a href="#">Pricebook #</a></li>
                                                <li onclick="setGlobalSearchPlaceholder($(this).first().text());"><a href="#">Field Ticket #</a></li>
                                                <li onclick="setGlobalSearchPlaceholder($(this).first().text());"><a href="#">Purchase Order #</a></li>
                                            </ul>

                                            <input class="form-control" id="globalSearch" placeholder="Invoice #">

                                            <span class="input-group-btn">
                                                <button class="btn btn-default"><i class="fas fa-search fa-fw"></i></button>
                                            </span>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a title="Message Centre" class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <span class="badge badge-xs">49</span>
                        <i class="fas fa-bell fa-fw"></i>
                        <!-- <span class="hidden-xs hide">Messages</span> -->
                    </a>
                    <ul class="dropdown-menu dropdown-menu-right">
                        <li>
                            <a title="Message Centre" href="#">
                                <span class="fa-fw">
                                    <i class="fas fa-envelope"></i>
                                    Messages
                                </span>
                                <sup class="badge" style="background:#BE3A34">41</sup>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <span class="fa-fw">
                                    <i class="fas fa-file-alt"></i>
                                    Completed Reports
                                </span>
                                <sup class="badge" style="background:#BE3A34">8</sup>
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a title="Help Center" class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fas fa-question-circle fa-fw"></i> <span class="hidden-xs hide">Help</span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-right">
                        <li><a href="#"><i class="fas fa-life-ring fa-fw"></i> Contact Support</a></li>
                        <li><a href="#"><i class="fas fa-book fa-fw"></i> Resource Center</a></li>
                        <li><a href="#"><i class="fas fa-comment fa-fw"></i> Feedback</a></li>
                        <li><a href="#"><i class="fas fa-users fa-fw"></i> About</a></li>
                        <li><a href="#"><i class="fas fa-user-secret fa-fw"></i> Privacy</a></li>
                        <li><a href="#"><i class="fas fa-gavel fa-fw"></i> Terms</a></li>
                        <li><a href="#"><i class="fas fa-globe fa-fw"></i> Browsers</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a title="My Profile" class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fas fa-user fa-fw"></i> <span class="hidden-xs hide">Profile</span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-right">
                        <li><a href="#"><i class="fas fa-user fa-fw"></i> Christopher Schwartzenberg</a></li>
                        <li><a href="#"><i class="fas fa-cog fa-fw"></i> Preferences</a></li>
                        <li><a href="#"><i class="fas fa-font fa-fw"></i> Font Size</a></li>
                    </ul>
                </li>
                <li><a title="Sign Out" href="#"><i class="fas fa-sign-out fa-fw"></i></a></li>
            </ul>
        </div>
        <ul class="nav navbar-nav navbar-left">
            <li class="pull-left">
                <p class="navbar-text hide-overflow small hidden-sm hidden-xs" style="max-width: 225px;">Tetratrex
                    Oilfield Services Incorporated Ltd.
                </p>
            </li>
        </ul>
        <ul class="nav navbar-nav navbar-right visible-sm visible-md visible-lg hidden-xs">
            <li class="pull-left">
                <a class="label-success navbar-link">
                    <i class="fas fa-sack-dollar fa-fw"></i>
                    <div class="pull-right" style="width: 60px; white-space: normal;float:right;line-height: 1;font-size: 13px; text-align: center;">Get Paid Faster! </div>
                </a>
            </li>
            <li>
                <form class="navbar-form navbar-right">
                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="false">
                                <span class="caret"></span>
                            </span>
                            <ul class="dropdown-menu dropdown-menu-left">
                                <li onclick="setGlobalSearchPlaceholder($(this).first().text());"><a href="#">Invoice #</a></li>
                                <li onclick="setGlobalSearchPlaceholder($(this).first().text());"><a href="#">Pricebook #</a></li>
                                <li onclick="setGlobalSearchPlaceholder($(this).first().text());"><a href="#">Field Ticket #</a></li>
                                <li onclick="setGlobalSearchPlaceholder($(this).first().text());"><a href="#">Purchase Order #</a></li>
                            </ul>

                            <input class="form-control" id="globalSearch" placeholder="Invoice #">

                            <span class="input-group-btn">
                                <button class="btn btn-default"><i class="fas fa-search fa-fw"></i></button>
                            </span>
                        </div>
                    </div>
                </form>
            </li>
        </ul>
    </div>
</nav>

<nav id="secondaryNavbar" class="navbar-default animated navbar-fixed-top " style="z-index: 1030">
    <div class="container-fluid">
        <div class="row">
                <div class="col-xs-4">
                            <div class="btn-group  pull-left">
                                <button class="btn btn-link text-nowrap dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                    <i class="fas fa-arrow-left fa-fw"></i> Back <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a href="#">Supplier On-Ramping</a></li>
                                    <li><a href="#">Suppliers</a></li>
                                    <li><a href="#">Dashboard</a></li>
                                </ul>
                            </div>
                </div>
                <div class="col-xs-4 text-center hide-overflow">
                    <div class="form-control-static">
                        Field Tickets
                    </div>
                </div>
                <div class="col-xs-4 text-right text-nowrap">
                </div>
            </div>
        </div>
    </div>
</nav>


<div class="container-fluid page-top-padding">
    <div class="panel panel-default">
        <div class="panel-body">
            <div id="filters2" class="row animate collapse">
                <div class="col-xs-4">
                    <div class="form-group">
                        <label class="control-label">Service Category</label>
                        <select id="table-filter" class="form-control"></select>
                    </div>
                </div>
                <div class="col-xs-8">
                    &nbsp;
                </div>
                <div class="col-xs-12">
                    <hr />
                </div>
            </div>

            <div class="row">
                <div class="col-xs-6">
                    <div class="form-group">

                        <div class="btn-group  hidden-xs hidden-sm visible-md visible-lg">
                            <a href="#" class="btn btn-default"> Bulk Update </a>
                            <a href="#" class="btn btn-default"> Export.. </a>
                            <div class="btn-group">
                                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
                                    aria-expanded="false">
                                    Save As <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu dropdown-menu-right">
                                    <li><a href="#"> New Stack </a></li>
                                    <li><a href="#"> Existing Stack</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="btn-group visible-xs visible-sm hidden-md hidden-lg">
                            <button type="button" class="btn btn-default "  >

            Actions
</button>


                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span class="caret"></span>
                                <span class="sr-only"></span>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-left">
                                <li><a href="#"><i class="fas fa-plus-circle"></i> Add</a></li>
                                <li><a href="#"><i class="fas fa-download"></i> Download</a></li>
                                <li><a href="#"><i class="fas fa-upload"></i> Upload</a></li>
                                <li><a href="#"><i class="fas fa-trash"></i> Delete</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-xs-6 text-right">
                    <div class="form-group">
                        <div class="btn-group text-nowrap">
                            <button class="btn btn-default" data-toggle="collapse" href="#filters2"><i class="fas fa-filter"></i> Advanced Filters</a>

                            <div class="btn-group">
                                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Columns <span class="caret"></span>
                                </button>
                                <ul id="ticketColumnSelector" class="dropdown-menu dropdown-menu-right">
                                        <li>
                                            <a class="toggle-vis">
                                             <div class="checkbox" style="margin-top: 5px; margin-bottom: 5px;">
                                                <label>
                                                    <input type="checkbox" checked> AFE
                                                </label>
                                            </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a class="toggle-vis">
                                             <div class="checkbox" style="margin-top: 5px; margin-bottom: 5px;">
                                                <label>
                                                    <input type="checkbox" checked> Amount
                                                </label>
                                            </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a class="toggle-vis">
                                             <div class="checkbox" style="margin-top: 5px; margin-bottom: 5px;">
                                                <label>
                                                    <input type="checkbox" > Attachments
                                                </label>
                                            </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a class="toggle-vis">
                                             <div class="checkbox" style="margin-top: 5px; margin-bottom: 5px;">
                                                <label>
                                                    <input type="checkbox" checked> Coding
                                                </label>
                                            </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a class="toggle-vis">
                                             <div class="checkbox" style="margin-top: 5px; margin-bottom: 5px;">
                                                <label>
                                                    <input type="checkbox" checked> Cost Center
                                                </label>
                                            </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a class="toggle-vis">
                                             <div class="checkbox" style="margin-top: 5px; margin-bottom: 5px;">
                                                <label>
                                                    <input type="checkbox" > Currency
                                                </label>
                                            </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a class="toggle-vis">
                                             <div class="checkbox" style="margin-top: 5px; margin-bottom: 5px;">
                                                <label>
                                                    <input type="checkbox" > Location
                                                </label>
                                            </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a class="toggle-vis">
                                             <div class="checkbox" style="margin-top: 5px; margin-bottom: 5px;">
                                                <label>
                                                    <input type="checkbox" > Product&#x2F;Service
                                                </label>
                                            </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a class="toggle-vis">
                                             <div class="checkbox" style="margin-top: 5px; margin-bottom: 5px;">
                                                <label>
                                                    <input type="checkbox" checked> Requisitioner
                                                </label>
                                            </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a class="toggle-vis">
                                             <div class="checkbox" style="margin-top: 5px; margin-bottom: 5px;">
                                                <label>
                                                    <input type="checkbox" > Service Category
                                                </label>
                                            </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a class="toggle-vis">
                                             <div class="checkbox" style="margin-top: 5px; margin-bottom: 5px;">
                                                <label>
                                                    <input type="checkbox" checked> Service Date
                                                </label>
                                            </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a class="toggle-vis">
                                             <div class="checkbox" style="margin-top: 5px; margin-bottom: 5px;">
                                                <label>
                                                    <input type="checkbox" checked> Status
                                                </label>
                                            </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a class="toggle-vis">
                                             <div class="checkbox" style="margin-top: 5px; margin-bottom: 5px;">
                                                <label>
                                                    <input type="checkbox" > Superintendent
                                                </label>
                                            </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a class="toggle-vis">
                                             <div class="checkbox" style="margin-top: 5px; margin-bottom: 5px;">
                                                <label>
                                                    <input type="checkbox" checked> Supplier Name
                                                </label>
                                            </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a class="toggle-vis">
                                             <div class="checkbox" style="margin-top: 5px; margin-bottom: 5px;">
                                                <label>
                                                    <input type="checkbox" checked> Ticket Number
                                                </label>
                                            </div>
                                            </a>
                                        </li>
                                </ul>
                                <script>
                                    $('#ticketColumnSelector.dropdown-menu').on({
                                        "click":function(e){
                                            e.stopPropagation();
                                        }
                                    });

                                </script>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- <div id="filters2" class="form-group animate collapse">
                <div class="col-xs-12">
                    <fieldset class="form-group">
                        <legend class="small">Advanced Filters</legend>
                        <form class="form-inline" role="form">
                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label for="input1" class="control-label">Column 1: &nbsp;</label>
                                        <div class="input-group">
                                            <input type="text" class="form-control" placeholder="Type to search">
                                            <span class="input-group-addon">
                                                <i class="fas fa-search"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label for="input2" class="control-label">Column 2: &nbsp;</label>
                                        <div class="input-group">
                                            <input type="text" class="form-control" placeholder="Type to search">
                                            <span class="input-group-addon">
                                                <i class="fas fa-search"></i>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </fieldset>
                </div>
            </div> -->

            <div class="well-sm">
                <div class="table-responsive">
                    <table id="paginatedTicketList" class="table table-striped table-hover table-bordered" style="width:100%">
                        <thead>
                            <tr class="text-nowrap">
                                <th>
                                    <div class="checkbox"><label> <input id="selectAll" type="checkbox"></label></div>
                                    <div> Select All </div>
                                </th>
                                <th>Alert</th>
                                <th>Ticket Number</th>
                                <th>Supplier Name</th>
                                <th>Service Category</th>
                                <th>Product/Service</th>
                                <th>Service Date</th>
                                <th>AFE</th>
                                <th>Cost Center</th>
                                <th>Requisitioner</th>
                                <th>Superintendent</th>
                                <th>Location</th>
                                <th>Coding</th>
                                <th>Currency</th>
                                <th class="text-center">Amount</th>
                                <th class="text-center">Status</th>
                                <th class="text-center">Attachments</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="ticketListConfirmDialog" class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                        <div class="lead modal-title">
                            Are You Sure?
                        </div>
                    </div>
                <div class="modal-body">
                    <p>Displaying all records may result in slow rendering of the ticket list.  Are you sure you want to display all records?</p>
                </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default "  >

            No, revert my selection
</button>

                        <button type="button" class="btn btn-success "  >

            Yes, I&#39;m sure
</button>

                    </div>
            </div>
        </div>
    </div>
<script>
    // Initialize the paginated list datatable
    $(document).ready(function() {
        var ticketList;
        var serviceCategoryList = [];
        var servicesList = [];
        var selectedServiceCategory;


        $('body').addClass('page-bg');
        $('html').addClass('page-bg');

        ticketList = $('#paginatedTicketList').DataTable( {
            responsive: true,
            colReorder: true,
            responsive: true,
            oLanguage: defaultDataTablesOLanguage,
            "lengthMenu": largeDataSetDataTablesLengthMenu,
            "order": [[ 2, "desc" ]],
            columns: [
                {
                    "width": 36,
                    "class": "text-center",
                    "orderable": false,
                    "targets": 'no-sort',
                    "render": function(data, type, row, meta) {
                       return (
                            '<div class="checkbox"><label><input class="ticketSelect" type="checkbox"></label></div>'
                        );
                    }
                },
                {
                    "width": 36,
                    "class": "text-center",
                    data: 'ticketAlert',
                    "name": "Alert",
                    "render": function(data, type, row, meta) {
                        if (row["ticketAlert"] == true) {
                            return (
                                '<i class="fas fa-shield-alt text-success"></i>'
                                //'<i class="fas fa-exclamation-triangle text-danger"></i>'
                            )
                        } else {
                            return ' '
                        }
                    }
                },
                { data: 'ticketNumber', "name": "Ticket Number" },
                { data: 'supplierName',  "name": "Supplier Name", "class": "text-nowrap"},
                {
                    data: 'serviceCategory',
                    name: "Service Category",
                    "visible": false,
                     "class": "text-nowrap"
                },
                { data: 'productService', "name": "Product/Service", "class":"text-nowrap", "visible": false,},
                {
                    "width": 85,
                    "class": "text-center text-nowrap",
                    data: 'serviceDate',
                    "name": "Service Date"
                },
                {   data: 'afe', "name": "AFE" },
                {   data: 'cc', "name": "Cost Center" },
                {   data: 'requisitioner', "name": "Requisitioner", "class": "text-nowrap"},
                {   data: 'superintendent', "name": "Superintendent", "class": "text-nowrap","visible": false},
                { data: 'location', "name": "Location","class": "text-nowrap","visible": false},
                {
                    "width": 90,
                    "class": "text-center",
                    data: 'coding',
                    "name": 'Coding'
                },
                {
                    "width": 60,
                    "class": "text-center",
                    "visible": false,
                    data: 'currency',
                    "name": "Currency"
                },
                {
                    "class": "text-right",
                    data: 'amount',
                    "name": "Amount",
                    render: $.fn.dataTable.render.number( ',', '.', 2, ' ' )
                },
                {
                    "class": "text-center",
                    data: 'status',
                    "name": "Status"
                },
                {
                    "width": 75,
                    "class": "text-center",
                    "visible": false,
                    data: 'attachments',
                    "name": "Attachments"
                }
            ],
            "ajax": "../../styleguide/data/rangeResourcesTicketData.json",
            "sDom": defaultDataTablesSDom,
            "createdRow": function (row, data, dataIndex) {
                if(serviceCategoryList.indexOf(data.serviceCategory) == -1) {
                    serviceCategoryList.push(data.serviceCategory);
                }

                if(servicesList.indexOf(data.productService) == -1) {
                    servicesList.push(data.productService);
                }
            },
            "footerCallback": function (row, data, start, end, display) {
                var api = this.api();
                var selectField = $('#table-filter');
                selectField.empty();
                var html = '<option id="optionAll" value="">All</option>';
                $.each(serviceCategoryList, function (i, item) {
                    html += '<option id="option' +item +'" value="' + item + '">' +item + '</option>';
                });
                selectField.append(html);
                selectField.val(selectedServiceCategory);
            }
        } );

        $("#selectAll").on( "click", function(e) {
            var checkboxes = ticketList.rows().nodes().to$().find('input[type="checkbox"]');

            if ($(this).is( ":checked" )) {
                checkboxes.each(function() {
                    $(this).prop('checked', true);
                });
            } else {
                checkboxes.each(function() {
                    $(this).prop('checked', false);
                });
            }
        });

        $('#paginatedTicketList_length select').on( 'change', function (evt) {
            if($(this).val() == -1) {
                $('#ticketListConfirmDialog').modal();
            }
        } );

        function setSelectedIndex(s, i){
            s.options[i].selected = true;
            return;
        }

        $('#table-filter').on('change', function(){
            for ( var i = 0; i < this.options.length; i++ ) {
                if ( this.options[i].text == this.value ) {
                    this.options[i].selected = true;
                    this.value = this.options[i].text;
                    break;
                }
            }
            selectedServiceCategory = this.value;
            ticketList.column(4).search( this.value ).draw();
            setSelectedIndex(document.getElementById('table-filter'), i);
        });

        $('#ticketColumnSelector li a').on("click", function(event) {
            var closestCheckbox = $(this).closest('li').find('input[type=checkbox]');
            var closestLabelText = $(this).closest('li').find('label').text().trim();

            if(closestCheckbox.prop('checked') == false) {
                closestCheckbox.prop('checked', true);
            } else {
                closestCheckbox.prop('checked', false);
            }
            event.stopPropagation();
            var columnIndex = ticketList.column(closestLabelText +":name").index();
            //event.preventDefault();

            // Get the column API object
            var column = ticketList.column(columnIndex);

            // Toggle the visibility
            column.visible( ! column.visible() );
        });
    } );
</script>
